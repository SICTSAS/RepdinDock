<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>AMERIKA-IA</title>
    <style>
        body { background-color: #f2f2f2; font-family: Arial, sans-serif; padding: 30px; }
        .banner { text-align: center; }
        .banner img { width: 100%; }
        .container { max-width: 850px; margin: 0 auto; background: #fff; border-radius: 8px; padding: 25px 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        h2 { color: #2c3e50; }
        label { font-weight: bold; }
        input[type="text"], input[type="date"] { width: 80%; padding: 10px; margin-top: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; }
        button { background-color: #0077cc; color: white; border: none; padding: 10px 20px; border-radius: 4px; margin-right: 10px; cursor: pointer; }
        button:hover { background-color: #005fa3; }
        #respuesta { margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        table, th, td { border: 1px solid #ccc; }
        th, td { padding: 8px; text-align: left; }
        th { background-color: #f4f4f4; }
        img.grafica { max-width: 100%; margin-top: 15px; border: 1px solid #ccc; }
    </style>
</head>
<body>

    <div class="banner">
        <img src="https://soporte.amerikatis.co/img/Banner_AMERIKA.png" alt="Banner AMERIKATIS">
    </div>
	
    <h1>Reporteador Dinamico AURA - AMERIKA_IA</h1>
    <p>Escribe tu peticion en lenguaje natural, para proceso de Facturación del Sistema Amerika.</p>
    
<style>
    #userInput {
        width: 100%;            /* Ocupa todo el ancho disponible */
        max-width: 820px;       /* Fija un ancho máximo */
        height: 120px;          /* Mantiene la altura del textarea */
        resize: none;           /* Impide que el usuario cambie el tamaño */
        padding: 12px;
        font-size: 15px;
        border: 1px solid #ccc;
        border-radius: 6px;
        display: block;
        margin-bottom: 15px;
    }
</style>

<textarea id="userInput"
    placeholder="Ejemplo: Necesito saber el total facturado en el periodo de Octubre del 2025."
    rows="5">
</textarea>
<button onclick="enviarAn8n()">Enviar Peticion</button>
    
    <div id="respuesta">Esperando tu mensaje...</div>

    <script>
        // IMPORTANTE: Deberas reemplazar 'URL_DE_TU_WEBHOOK_N8N' por la URL real de tu nodo Webhook cuando lo configures.
        //const webhookURL = 'https://repodinamik.up.railway.app/webhook/RepDinAmk';                              
        const webhookURL = 'http://localhost:5678/webhook-test/RepDinAmk';
		                     

        function enviarAn8n() {
            const peticion = document.getElementById('userInput').value.trim();
            const respuestaElement = document.getElementById('respuesta');

            if (peticion === "") {
                respuestaElement.textContent = "Por favor, escribe una peticion.";
                return;
            }
            
            respuestaElement.textContent = "Enviando...";

            // Uso de fetch para enviar la peticion via POST
            fetch(webhookURL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    // Esta es la clave que usarÃ¡s en n8n: $json.body.peticionUsuario
                    peticionUsuario: peticion 
                })
            })
            .then(response => {
                if (response.ok) {
                    respuestaElement.textContent = 'Peticion enviada correctamente. Revisa tu flujo de n8n!';
                    document.getElementById('userInput').value = ''; 
                } else {
                    respuestaElement.textContent = `Error al enviar la peticion. Codigo de respuesta: ${response.status}. Asegurate que la URL es correcta.`;
                }
            })
            .catch(error => {
                respuestaElement.textContent = 'Error de conexion. Revisa si el Webhook esta¡ activo y la URL es accesible.';
                console.error('Error:', error);
            });
        }
    </script>
</body>
</html>
